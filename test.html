<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éƒµé‡‘ç¿»è­¯ v3.0 æ¸¬è©¦ç‰ˆ</title>
    <style>
        :root { --primary: #007d32; --accent: #1877F2; }
        body { font-family: sans-serif; background: #f0f2f5; padding: 20px; display: flex; justify-content: center; }
        .card { background: white; width: 100%; max-width: 500px; padding: 25px; border-radius: 15px; shadow: 0 4px 10px rgba(0,0,0,0.1); }
        select, textarea { width: 100%; padding: 10px; margin: 10px 0; border-radius: 8px; border: 1px solid #ddd; box-sizing: border-box; }
        .btn-mic { background: #dc3545; color: white; border: none; padding: 15px; width: 100%; border-radius: 8px; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .btn-translate { background: var(--primary); color: white; border: none; padding: 15px; width: 100%; border-radius: 8px; cursor: pointer; font-weight: bold; }
        #status { font-size: 12px; text-align: center; margin-bottom: 10px; }
        #result { background: #f8f9fa; padding: 15px; border-left: 5px solid var(--primary); margin-top: 15px; min-height: 50px; border-radius: 4px; }
    </style>
</head>
<body>

<div class="card">
    <h2>éƒµé‡‘ç¿»è­¯ v3.0 (èªéŸ³æ¸¬è©¦)</h2>
    
    <div id="status">â— ç³»çµ±æº–å‚™å°±ç·’</div>

    <label>1. é¸æ“‡å®¢æˆ¶èªªçš„èªè¨€ï¼š</label>
    <select id="langSelect">
        <option value="en-US">è‹±æ–‡ (English)</option>
        <option value="vi-VN">è¶Šå—æ–‡ (Tiáº¿ng Viá»‡t)</option>
        <option value="id-ID">å°å°¼æ–‡ (Bahasa Indonesia)</option>
        <option value="th-TH">æ³°æ–‡ (à¹„à¸—à¸¢)</option>
    </select>

    <button id="micBtn" class="btn-mic" onclick="startSpeech()">ğŸ¤ é»æ“Šé–‹å§‹éŒ„éŸ³ (è¾¨è­˜å®¢æˆ¶æ¯èª)</button>
    
    <textarea id="inputText" placeholder="èªéŸ³è¾¨è­˜çµæœå°‡é¡¯ç¤ºåœ¨æ­¤ï¼Œæˆ–æ‰‹å‹•è¼¸å…¥..."></textarea>
    
    <button class="btn-translate" onclick="doTranslate()">ç¿»è­¯æˆä¸­æ–‡ (å¥—ç”¨è©åº«)</button>

    <div id="result">ç¿»è­¯çµæœ...</div>
</div>

<script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbwrJwV3vhEaYeB5t9sGaRia5Z9kRWknOJnj7d9mZN-bwjSf2AoofyzCS2tsgIIVBQZv/exec";

    // èªéŸ³è¾¨è­˜è¨­å®š
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = new SpeechRecognition();

    function startSpeech() {
        const lang = document.getElementById('langSelect').value;
        recognition.lang = lang;
        recognition.start();
        document.getElementById('status').innerText = "â— æ­£åœ¨è†è½ " + lang + "...";
        document.getElementById('micBtn').style.background = "#ffc107";
    }

    recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        document.getElementById('inputText').value = transcript;
        document.getElementById('status').innerText = "â— è¾¨è­˜æˆåŠŸ";
        document.getElementById('micBtn').style.background = "#dc3545";
    };

    async function doTranslate() {
        const text = document.getElementById('inputText').value;
        const resultDiv = document.getElementById('result');
        if(!text) return;

        resultDiv.innerText = "æ­£åœ¨é€²è¡Œå¤šåœ‹èªè¨€è½‰æ›...";

        try {
            const response = await fetch(GAS_URL, {
                method: "POST",
                body: JSON.stringify({ action: "translate", text: text, target: "zh-TW" })
            });
            const data = await response.json();
            resultDiv.innerText = data.result;
        } catch (e) {
            resultDiv.innerText = "ç¿»è­¯å¤±æ•—ï¼Œè«‹æª¢æŸ¥ API è¨­å®šã€‚";
        }
    }
</script>
</body>
</html>
